import{e as N,g as $}from"./chunk-BGTXLFTF.js";import{a as D}from"./chunk-BBROM2H7.js";import{a as F}from"./chunk-AN5DEFWR.js";import"./chunk-4PMXRNRY.js";import{a as I,b as i,c as V,d as R,e as E,f as d,g as A,h as z,i as G,k as j}from"./chunk-2E4IN3VD.js";import{$a as v,Ea as u,I as h,Nb as T,Oa as B,Qb as k,Sa as O,Ya as g,_ as M,db as o,eb as e,fa as b,fb as m,ga as w,gb as y,ib as f,jb as C,k as _,la as S,sb as s,tb as L,wb as P,yb as l,zb as p}from"./chunk-FOUY5J7Y.js";var q=r=>({active:r}),K=r=>({invalid:r});function H(r,a){if(r&1){let n=y();o(0,"form",12)(1,"label",13),s(2,"\u041B\u043E\u0433\u0438\u043D"),e(),m(3,"input",14),o(4,"label",15),s(5,"\u041F\u0430\u0440\u043E\u043B\u044C"),e(),m(6,"input",16),o(7,"small-button",17),l(8,"async"),f("click",function(c){b(n);let x=C();return w(x.login(c))}),e(),o(9,"button",18),s(10,"\u0417\u0430\u0431\u044B\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C?"),e()()}if(r&2){let n=C();g("formGroup",n.authForm),u(7),g("buttonTitle","\u0412\u043E\u0439\u0442\u0438")("disabled",n.authForm.invalid)("loading",p(8,4,n.isLoading$)||!1)}}function J(r,a){r&1&&(o(0,"span",26),s(1,"\u041F\u0430\u0440\u043E\u043B\u0438 \u043D\u0435 \u0441\u043E\u0432\u043F\u0430\u0434\u0430\u044E\u0442."),e())}function Q(r,a){if(r&1){let n=y();o(0,"form",12)(1,"label",19),s(2,"\u041B\u043E\u0433\u0438\u043D"),e(),m(3,"input",20),o(4,"div",21),l(5,"async"),o(6,"label",22),s(7,"\u041F\u0430\u0440\u043E\u043B\u044C"),e(),m(8,"input",23),o(9,"label",24),s(10,"\u041F\u0430\u0440\u043E\u043B\u044C"),e(),m(11,"input",25),O(12,J,2,0,"span",26),l(13,"async"),e(),o(14,"small-button",17),l(15,"async"),l(16,"async"),f("click",function(c){b(n);let x=C();return w(x.registerNewUser(c))}),e(),o(17,"button",18),s(18,"\u0417\u0430\u0431\u044B\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C?"),e()()}if(r&2){let n,t=C();g("formGroup",t.registerForm),u(4),g("ngClass",P(14,K,p(5,6,t.passwordsNotMatch$)&&((n=t.registerForm.get("password_reaped"))==null?null:n.touched))),u(8),v(p(13,8,t.passwordsNotMatch$)?12:-1),u(2),g("buttonTitle","\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C\u0441\u044F")("disabled",t.registerForm.invalid||p(15,10,t.passwordsNotMatch$)||!1)("loading",p(16,12,t.isLoading$)||!1)}}var U=class r{authService=M($);destroyRef=M(S);router=M(N);authForm=new E({username:new d("",[i.required,i.maxLength(100),i.email]),password:new d("",[i.required,i.maxLength(100),i.minLength(6)])});registerForm=new E({username:new d("",[i.required,i.maxLength(100),i.email]),password:new d("",[i.required,i.maxLength(100),i.minLength(6)]),password_reaped:new d("",[i.required,i.maxLength(100),i.minLength(6)])});isLoading$=new _(!1);formType$=new _("login");errorMessage="";passwordsNotMatch$=new _(!1);ngOnInit(){this.registerForm.valueChanges.subscribe(a=>{a.password!==a.password_reaped?this.passwordsNotMatch$.next(!0):a.password===a.password_reaped&&this.passwordsNotMatch$.next(!1)})}login(a){this.isLoading$.next(!0);try{a.preventDefault()}catch{}this.disableInputs();let{username:n,password:t}=this.authForm.value;this.authService.login(n,t).pipe(h(()=>{this.isLoading$.next(!1),this.enableInputs()}),F(this.destroyRef)).subscribe({next:c=>{this.authService.saveUser(c),this.authService.isAuthorized.next(!0),this.router.navigate([""]).then(()=>{window.location.reload()})},error:c=>{this.errorMessage=c.errorText?c.errorText:"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437 \u0438\u043B\u0438 \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0443.",console.error(c)}})}disableInputs(){this.authForm.get("password")?.disable(),this.authForm.get("username")?.disable(),this.registerForm.get("password")?.disable(),this.registerForm.get("username")?.disable()}enableInputs(){this.authForm.get("password")?.enable(),this.authForm.get("username")?.enable(),this.registerForm.get("password")?.enable(),this.registerForm.get("username")?.enable()}changeFormType(a){this.formType$.next(a)}registerNewUser(a){this.isLoading$.next(!0),this.disableInputs(),this.authService.registerUser(this.registerForm.value.username,this.registerForm.value.password).pipe(h(()=>{this.isLoading$.next(!1),this.enableInputs()}),F(this.destroyRef)).subscribe({next:n=>{n&&(this.authForm.setValue({username:this.registerForm.value.username,password:this.registerForm.value.password}),this.login(n))},error:n=>{console.log(n),n.status===409?this.errorMessage="\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u0441 \u0442\u0430\u043A\u0438\u043C \u043B\u043E\u0433\u0438\u043D\u043E\u043C \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D.":this.errorMessage=n.errorText?n.errorText:"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437 \u0438\u043B\u0438 \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0443."}})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=B({type:r,selectors:[["app-login"]],decls:24,vars:16,consts:[[1,"container"],[1,"left-section"],["src","assets/icons/logo.svg","alt","small-logo"],[1,"info"],[1,"title"],[1,"description"],["src","assets/images/big-full-logo.svg","alt","big-full-logo"],[1,"form-section"],[1,"form-container"],[1,"action-buttons"],[3,"click","ngClass"],[1,"error-text"],[3,"formGroup"],["for","login"],["id","login","type","text","formControlName","username"],["for","password"],["id","password","type","password","formControlName","password"],[1,"enter",3,"click","buttonTitle","disabled","loading"],[1,"forgot-password"],["for","login-2"],["id","login-2","type","text","formControlName","username"],[1,"inputs",3,"ngClass"],["for","password-reaped"],["id","password-reaped","type","password","formControlName","password"],["for","password-reaped-2"],["id","password-reaped-2","type","password","formControlName","password_reaped"],[1,"passwords-not-match"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"div",1),m(2,"img",2),o(3,"div",3)(4,"span",4),s(5,"STOCK VISOR"),e(),o(6,"span",5),s(7,"\u041A\u0440\u0430\u0442\u043A\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u0430"),e()(),m(8,"img",6),e(),o(9,"div",7)(10,"div",8)(11,"div",9)(12,"button",10),l(13,"async"),f("click",function(){return t.changeFormType("login")}),s(14," \u0412\u043E\u0439\u0442\u0438 "),e(),o(15,"button",10),l(16,"async"),f("click",function(){return t.changeFormType("register")}),s(17," \u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C\u0441\u044F "),e()(),o(18,"span",11),s(19),e(),O(20,H,11,6,"form",12),l(21,"async"),l(22,"async"),O(23,Q,19,16,"form",12),e()()()),n&2&&(u(12),g("ngClass",P(12,q,p(13,4,t.formType$)==="login")),u(3),g("ngClass",P(14,q,p(16,6,t.formType$)==="register")),u(4),L(t.errorMessage),u(),v(p(21,8,t.formType$)==="login"?20:p(22,10,t.formType$)==="register"?23:-1))},dependencies:[D,j,A,I,V,R,z,G,k,T],styles:['.container[_ngcontent-%COMP%]{background:linear-gradient(96.2deg,#0056fe 48.93%,#3479ff47 109.55%);height:100vh;width:100vw;display:flex;min-width:900px}.container[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]{flex-basis:55%;display:flex;flex-direction:column;min-width:486px}.container[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   img[alt=big-full-logo][_ngcontent-%COMP%]{width:100%;margin-top:auto}.container[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   img[alt=small-logo][_ngcontent-%COMP%]{height:150px;width:250px}.container[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:#fff;display:flex;flex-direction:column;margin-top:100px;margin-left:12%}.container[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:50px;font-weight:500}.container[_ngcontent-%COMP%]   .left-section[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-weight:400;font-size:26px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{flex-basis:45%;background-color:#eff1f7;border-top-left-radius:100px;display:flex;align-items:center;justify-content:center;min-width:626px;min-height:860px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background-color:#fff;position:relative;height:748px;box-shadow:15px 10px 16px #d2dae3b2,5px 5px 13px #d2dae34d,-5px -5px 10px #fff,-20px -20px 18px #fffc;border-radius:40px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{height:104px;background-color:#fff;width:100%;border-top-left-radius:40px;border-top-right-radius:40px;padding-left:54px;padding-top:54px;display:flex;gap:40px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:none;cursor:pointer;border-radius:6px;font-size:26px;font-weight:700;color:#a3abc3;padding:18px;display:flex;align-items:center;border-bottom:4px solid transparent;transition:border-bottom-color .3s}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#eff1f78a}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:#000;border-bottom:4px solid #0056FE}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{background-color:#eff1f7;padding:130px 40px 0;display:flex;flex-direction:column;width:464px;min-width:580px;height:100%;border-radius:40px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:14px;padding-left:10px;color:#a3abc3}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid #A3ABC3;height:56px;border-radius:10px;background-color:transparent;font-size:18px;padding-left:10px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   #login[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   #login-2[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   #password-reaped[_ngcontent-%COMP%]{margin-bottom:30px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .enter[_ngcontent-%COMP%]{margin-top:60px;margin-bottom:40px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .forgot-password[_ngcontent-%COMP%]{color:#f55;background-color:transparent;cursor:pointer;width:fit-content;margin-left:auto;margin-right:auto;font-size:16px;font-weight:500;position:relative;border-radius:8px;height:30px;border:1px solid transparent}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .forgot-password[_ngcontent-%COMP%]:hover{border:1px solid rgb(222,226.125,238.5)}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .forgot-password[_ngcontent-%COMP%]:active{background-color:#e8ebf4}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .forgot-password[_ngcontent-%COMP%]:after{content:"";display:block;width:92%;height:2px;background-color:currentColor;position:absolute;bottom:0;left:6px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:#f55;font-size:18px;position:absolute;top:130px;left:40px;font-weight:500;width:86%}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .passwords-not-match[_ngcontent-%COMP%]{display:none;position:absolute;bottom:-26px}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .inputs.invalid[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#f55}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .inputs.invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:#f55;outline-color:#f55}.container[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .inputs.invalid[_ngcontent-%COMP%]   .passwords-not-match[_ngcontent-%COMP%]{display:block;margin-top:12px;color:#f55}']})};export{U as LoginComponent};

import{a as I}from"./chunk-OS6NPZQN.js";import{a as U}from"./chunk-UBV2OQUQ.js";import{a as y}from"./chunk-AN5DEFWR.js";import"./chunk-4PMXRNRY.js";import{a as k,b as u,c as R,d as T,e as $,f,g as q,h as G,i as z,j,k as Q}from"./chunk-2E4IN3VD.js";import{Ca as M,Ea as l,I as w,Nb as N,Oa as O,Qb as A,Ya as m,_,db as r,eb as n,fa as d,fb as a,ga as c,gb as S,ib as C,k as P,la as F,nb as x,ob as E,pb as D,qb as V,rb as B,sb as s,wb as b,yb as v,zb as h}from"./chunk-FOUY5J7Y.js";var J=["passwordInput"],Z=g=>({invalid:g}),L=class g{passwordInput;profileForm=new $({surname:new f("",[u.required,u.pattern("^[A-Za-z\u0410-\u042F\u0430-\u044F\u0401\u0451]+$")]),name:new f("",[u.required,u.pattern("^[A-Za-z\u0410-\u042F\u0430-\u044F\u0401\u0451]+$")]),username:new f("",u.required),password:new f("",u.required),role:new f("",u.required)});profileFormCopy={};dataService=_(I);destroyRef=_(F);loading$=new P(!1);ngOnInit(){this.dataService.getProfile().pipe(y(this.destroyRef)).subscribe(t=>{this.profileForm.setValue({surname:t.full_name?.split(" ")[0]||"",name:t.full_name?.split(" ")[1]||"",username:t.username,password:"",role:""}),this.profileFormCopy=this.profileForm.value}),this.disableFields()}togglePasswordVisibility(){let t=this.passwordInput.nativeElement.getAttribute("type");this.passwordInput.nativeElement.setAttribute("type",t==="password"?"text":"password")}onCancel(t){this.profileForm.get(t).setValue(this.profileFormCopy[t]),this.resetDirtyState(t)}resetDirtyState(t){this.profileForm.get(t).markAsPristine()}disableFields(){this.profileForm.get("username").disable(),this.profileForm.get("password").disable(),this.profileForm.get("role").disable()}onFullNameSave(){this.loading$.next(!0);let t=this.profileForm.get("surname").value+" "+this.profileForm.get("name").value;this.dataService.editUser({full_name:t,email:this.profileForm.get("username").value,front_st:new Date().getTime()}).pipe(y(this.destroyRef),w(()=>this.loading$.next(!1))).subscribe(i=>{this.profileFormCopy=this.profileForm.value,this.profileForm.setValue({surname:i.full_name?.split(" ")[0]||"",name:i.full_name?.split(" ")[1]||"",username:i.username,password:"",role:""}),this.resetDirtyState("surname"),this.resetDirtyState("name")})}static \u0275fac=function(i){return new(i||g)};static \u0275cmp=O({type:g,selectors:[["app-profile"]],viewQuery:function(i,e){if(i&1&&E(J,5),i&2){let o;D(o=V())&&(e.passwordInput=o.first)}},decls:36,vars:20,consts:[["passwordInput",""],[1,"container"],["action","",3,"formGroup"],[1,"section"],[1,"field",3,"ngClass"],["for","surname"],["id","surname","type","text","maxlength","24","formControlName","surname","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0430\u043C\u0438\u043B\u0438\u044E","autocomplete","off"],[3,"onSave","onCancel","hidden","disableSave","disable"],["for","name"],["id","name","type","text","maxlength","24","formControlName","name","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F"],[1,"field"],["for","login"],["id","login","type","text","maxlength","24","formControlName","username","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043B\u043E\u0433\u0438\u043D",3,"disabled"],["for","password"],["type","button",1,"password-visibility-button",3,"click"],[3,"src"],["id","password","type","password","maxlength","24","formControlName","password","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u0430\u0440\u043E\u043B\u044C"],["for","role"],["id","role","type","text","maxlength","24","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0440\u043E\u043B\u044C","formControlName","role"]],template:function(i,e){if(i&1){let o=S();r(0,"div",1)(1,"form",2)(2,"h1"),s(3,"\u041B\u0438\u0447\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435"),n(),r(4,"div",3)(5,"div",4)(6,"label",5),s(7,"\u0424\u0430\u043C\u0438\u043B\u0438\u044F"),n(),a(8,"input",6),r(9,"action-form-buttons",7),v(10,"async"),C("onSave",function(){return d(o),c(e.onFullNameSave())})("onCancel",function(){return d(o),c(e.onCancel("surname"))}),n()(),r(11,"div",4)(12,"label",8),s(13,"\u0418\u043C\u044F"),n(),a(14,"input",9),r(15,"action-form-buttons",7),v(16,"async"),C("onSave",function(){return d(o),c(e.onFullNameSave())})("onCancel",function(){return d(o),c(e.onCancel("name"))}),n()()(),a(17,"hr"),r(18,"div",3)(19,"h1"),s(20,"\u0414\u0430\u043D\u043D\u044B\u0435 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430"),n(),r(21,"div",10)(22,"label",11),s(23,"\u041B\u043E\u0433\u0438\u043D"),n(),a(24,"input",12),n(),r(25,"div",10)(26,"label",13),s(27,"\u041F\u0430\u0440\u043E\u043B\u044C"),n(),r(28,"button",14),C("click",function(){return d(o),c(e.togglePasswordVisibility())}),a(29,"img",15),n(),a(30,"input",16,0),n(),r(32,"div",10)(33,"label",17),s(34,"\u0420\u043E\u043B\u044C"),n(),a(35,"input",18),n()()()()}if(i&2){let o,p,H=B(31);l(),m("formGroup",e.profileForm),l(4),m("ngClass",b(16,Z,e.profileForm.get("surname").invalid&&((o=e.profileForm.get("surname"))==null?null:o.dirty))),l(4),m("hidden",!e.profileForm.get("surname").dirty)("disableSave",e.profileForm.get("surname").invalid)("disable",h(10,12,e.loading$)||!1),l(2),m("ngClass",b(18,Z,e.profileForm.get("name").invalid&&((p=e.profileForm.get("name"))==null?null:p.dirty))),l(4),m("hidden",!e.profileForm.get("name").dirty)("disableSave",e.profileForm.get("name").invalid)("disable",h(16,14,e.loading$)||!1),l(9),m("disabled",!0),l(5),x("src","assets/icons/Eye",H.type!=="password"?"-blue":"",".svg",M)}},dependencies:[Q,q,k,R,T,j,G,z,U,N,A],styles:[".container[_ngcontent-%COMP%]{background-color:#fff;height:calc(100vh - 110px);border-radius:10px;overflow:auto;padding:40px}.container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;font-weight:700;margin-bottom:30px}.container[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{background-color:#e8e8e8;height:1px;border:none;margin:50px 0}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin-bottom:20px;position:relative;width:fit-content}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:464px;height:48px;border:1px solid #A3ABC3;border-radius:10px;padding-left:16px}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#a3abc3}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field.invalid[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#f55}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field.invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:#f55;outline-color:#f55}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   input#password[_ngcontent-%COMP%]{padding-left:50px}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .password-visibility-button[_ngcontent-%COMP%]{position:absolute;top:38px;left:12px;width:30px;height:30px;cursor:pointer;border:none;background:transparent;display:flex;align-items:center;justify-content:center;padding:0;border-radius:50%}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .password-visibility-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.container[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .password-visibility-button[_ngcontent-%COMP%]:active{background-color:#e8e8e8}"]})};export{L as ProfileComponent};
